{% extends "base.html" %}

{% block page_title %}
  Wishlist Destination | Wisata Nusantara
{% endblock %}

{% block meta %}
<script>
  $(document).ready(function() {
    var allData = null
    var userLoggedIn = null
    var allSukaData = null
    var sukaUserData = [];

    // GET User Logged In
    $.ajax({
      url: "http://localhost:8000/auth/show-user-loggedin/json",
      type: "GET",
      success: function(data) {
        userLoggedIn = data;

        $("#hello-mobile").append(`<p>Hello, ${data[0].fields.username}!</p>`);
        $("#hello-tablet-desktop").append(`<p>Hello, ${data[0].fields.username}!</p>`);

        getAllDestinationData();
      }
    })

    // GET All Destination Data
    const getAllDestinationData = () => {
      $.ajax({
        url: "http://localhost:8000/destination/json",
        type: "GET",
        success: function(data) {
          allData = data;
          getAllSukaData();
        }
      })
    }

    // GET All Suka Destination Data
    const getAllSukaData = () => {
      $.ajax({
        url: "http://localhost:8000/destination/suka/json",
        type: "GET",
        success: function(data) {
          allSukaData = data;

          allSukaData.map((suka) => {
            if (suka.fields.user == userLoggedIn[0].pk) {
              sukaUserData.push(allData[suka.fields.destinasi-1]);
            }
          })

          sukaUserData.map((destinasi) => {
            $("#daftar-destinasi-mobile").append(destinationMobile(destinasi))
            $("#daftar-destinasi-tablet-desktop").append(destinationTabletDesktop(destinasi));
          })
        }
      })
    }

    // ================================ ALL ABOUT DESTINATION ====================================
    // Destination Card : Mobile
    const destinationMobile = (destinasi) => {
      return(`
        <div id="destinasi-card-mobile-${destinasi.pk}">
          <div class="p-4 hover:scale-105 transition duration-150 ease-in-out">
            <div class="bg-local rounded-3xl w-[200px] shadow-2xl" id="card" style="background-image:url(${destinasi.fields.foto_thumbnail_url});background-size:250px;">
              <div class="h-[210px]"></div>
              <div class="flex justify-between bg-white gap-3 items-center rounded-xl p-4 m-2 w-[185px]">
                <div>
                  <p class="font-bold text-[11px]">${destinasi.fields.nama}</p>
                  <p class="text-philippinesilver text-[9px]">${destinasi.fields.lokasi}</p>
                </div> 
                <div class="text-center">
                  <i class="fa fa-duotone fa-heart" style="font-size:24px;color:#BD4B4B"></i>
                  <p class="text-[9px]">${destinasi.fields.jumlah_suka}</p>
                </div>
              </div>
              <div class="h-[1px]"></div>
            </div>
          </div>
        </div>
      `)
    }
    // Destination Card : Tablet & Desktop
    const destinationTabletDesktop = (destinasi) => {
      return(`
        <div id="destinasi-card-tablet-desktop-${destinasi.pk}" class="destinasi-card">
          <div class="p-4 hover:scale-105 transition duration-150 ease-in-out">
            <div class="bg-local rounded-3xl w-[200px] shadow-2xl relative" id="card" style="background-image:url(${destinasi.fields.foto_thumbnail_url});background-size:250px;">
              <a href="/destination/delete/${destinasi.pk}" id="delete-card-button" class="hidden">
                <div class="absolute top-0 right-0">
                  <i class="bg-white rounded-full p-4 m-2 fa fa-solid fa-trash text-rose z-49 hover:scale-110 hover:bg-rose hover:text-white transition duration-150 ease-in-out"></i>
                </div>
              </a>
              <div class="h-[210px]"></div>
              <div class="flex justify-between bg-white gap-3 items-center rounded-xl p-4 m-2 w-[185px]">
                <div>
                  <p class="font-bold text-[11px]">${destinasi.fields.nama}</p>
                  <p class="text-philippinesilver text-[9px]">${destinasi.fields.lokasi}</p>
                </div> 
                <div class="text-center">
                  <i class="fa fa-duotone fa-heart" style="font-size:24px;color:#BD4B4B"></i>
                  <p class="text-[9px]">${destinasi.fields.jumlah_suka}</p>
                </div>
              </div>
              <div class="h-[1px]"></div>
            </div>
          </div>
        </div>
      `)
    }

  })
</script>
{% endblock %}

{% block content %}
<!-- MOBILE -->
<div class="tablet:hidden bg-gradient-to-r from-green-500 to-slate-500">
  <div>
    <div class="p-4">
      <p id="hello-mobile"></p>
      <p class="font-bold text-xl py-2">This is where you want to go</p>
    </div>

    <div>
      <div id="daftar-destinasi-mobile" class="flex overflow-x-auto"></div>
      <div id="daftar-destinasi-not-found-mobile"></div>
    </div>

    <div id="modalMobile"></div>
    <div id="modalAddDestinationMobile"></div>

  </div>

  <div class="flex justify-between bg-black rounded-tr-3xl rounded-tl-3xl pt-6 pb-8 px-10 mt-3">
    <a href="">
      <i class="fa-solid fa-house" style="font-size:20px;color:white"></i>
    </a>
    <a href="">
      <i class="fa-solid fa-calendar-days" style="font-size:20px;color:white"></i>
    </a>
    <a>
      <i class="fa-solid fa-heart" style="font-size:20px;color:white"></i>
    </a>
    <a>
      <i class="fa-solid fa-plus" style="font-size:20px;color:white"></i>
    </a>
    <a>
      <i class="fa-solid fa-user" style="font-size:20px;color:white"></i>
    </a>
  </div>
</div>

<!-- TABLET & DESKTOP -->
<div class="mobile:hidden tablet:block bg-gradient-to-r from-green-500 to-slate-500">
  <div class="flex">

    <div class="bg-zinc-900 px-8 py-4 cursor-pointer w-[140px]" id="sidebar-destination">
      <a href="/destination/" class="text-slate-300 hover:text-bone">
        <div class="flex items-center py-1">
          <i class="fa fa-solid fa-arrow-left" style="font-size:14px;color:#CBD5E1;"></i>
          <p class="pl-2">Back</p>
        </div>
      </a>
    </div>

    <div class="w-5/6">
      <div class="pl-8 pt-6 pb-4">
        <p id="hello-tablet-desktop"></p>
        <p class="font-bold text-xl pb-3">This is where you want to go</p>
      </div>

      <div class="pl-4">
        <div id="daftar-destinasi-tablet-desktop" class="flex flex-wrap"></div>
        <div id="daftar-destinasi-not-found-tablet-desktop"></div>
      </div>

      <div id="modalTabletDesktop"></div>
      <div id="modalAddDestinationTabletDesktop"></div>

      <div class="h-[200px]"></div>
    </div>

  </div>
</div>
{% endblock %}